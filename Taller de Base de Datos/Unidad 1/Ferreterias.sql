CREATE DATABASE FERRETERIAS
GO
USE FERRETERIAS
GO
-- CREACION DE TABLAS
CREATE TABLE ZONAS(
ZONAID INT NOT NULL,
ZONANOMBRE NVARCHAR(50) NOT NULL)
GO
CREATE TABLE MUNICIPIOS(
MUNID INT NOT NULL,
MUNNOMBRE NVARCHAR(50) NOT NULL)
GO
CREATE TABLE COLONIAS(
COLID INT NOT NULL,
COLNOMBRE NVARCHAR(50) NOT NULL,
COLCP NCHAR(5) NULL,
MUNID INT NOT NULL)
GO
CREATE TABLE FAMILIAS(
FAMID INT NOT NULL,
FAMNOMBRE NVARCHAR(50) NOT NULL,
FAMDESCRIPCION NVARCHAR(200) NULL)
GO
CREATE TABLE FERRETERIAS(
FERRID INT NOT NULL,
FERRNOMBRE NVARCHAR(20) NOT NULL,
FERRDOMICILIO NVARCHAR(50) NOT NULL,
FERRTELEFONO NCHAR(10) NOT NULL)
GO
CREATE TABLE EMPLEADOS(
EMPID INT NOT NULL,
EMPNOMBRE NVARCHAR(50) NOT NULL,
EMPAPEPAT NVARCHAR(50) NOT NULL,
EMPAPEMAT NVARCHAR(50) NULL,
EMPDOMICILIO NVARCHAR(50) NOT NULL,
EMPTELEFONO NCHAR(10) NULL,
EMPCELULAR NCHAR(10) NULL,
EMPRFC NCHAR(13) NULL,
EMPCURP NCHAR(18) NULL,
EMPFECHAINGRESO DATETIME NOT NULL,
EMPFECHANACIMIENTO DATETIME NOT NULL,
ZONAID INT NOT NULL,
JEFEID INT NULL)
GO
CREATE TABLE CLIENTES(
CTEID INT NOT NULL,
CTENOMBRE NVARCHAR(50) NOT NULL,
CTEAPEPAT NVARCHAR(50) NOT NULL,
CTEAPEMAT NVARCHAR(50) NULL,
CTEDOMICILIO NVARCHAR(50) NOT NULL,
CTETELEFONO NCHAR(10) NULL,
CTECELULAR NCHAR(10) NULL,
CTERFC NCHAR(13) NULL,
CTECURP NCHAR(18) NULL,
CTEFECHANACIMIENTO DATETIME NOT NULL,
CTESEXO NCHAR(1) NOT NULL,
COLID INT NOT NULL)
GO
CREATE TABLE ARTICULOS(
ARTID INT NOT NULL,
ARTNOMBRE NVARCHAR(20) NOT NULL,
ARTDESCRIPCION NVARCHAR(200) NOT NULL,
ARTPRECIO NUMERIC(10,2) NOT NULL,
FAMID INT NOT NULL)
GO
CREATE TABLE VENTAS(
FOLIO INT NOT NULL,
FECHA DATETIME NOT NULL,
FERRID INT NOT NULL,
CTEID INT NOT NULL,
EMPID INT NOT NULL)
GO
CREATE TABLE DETALLE(
FOLIO INT NOT NULL,
ARTID INT NOT NULL,
CANTIDAD NUMERIC(7,2) NOT NULL,
PRECIO NUMERIC(10,2) NOT NULL)
GO
-- CREACION DE LLAVES PRIMARIAS
ALTER TABLE ZONAS ADD CONSTRAINT PK_ZONAS PRIMARY KEY(ZONAID)
ALTER TABLE MUNICIPIOS ADD CONSTRAINT PK_MUNICIPIOS PRIMARY KEY(MUNID)
ALTER TABLE COLONIAS ADD CONSTRAINT PK_COLONIAS PRIMARY KEY(COLID)
ALTER TABLE FAMILIAS ADD CONSTRAINT PK_FAMILIAS PRIMARY KEY(FAMID)
ALTER TABLE FERRETERIAS ADD CONSTRAINT PK_FERRETERIAS PRIMARY KEY(FERRID)
ALTER TABLE EMPLEADOS ADD CONSTRAINT PK_EMPLEADOS PRIMARY KEY(EMPID)
ALTER TABLE CLIENTES ADD CONSTRAINT PK_CLIENTES PRIMARY KEY(CTEID)
ALTER TABLE ARTICULOS ADD CONSTRAINT PK_ARTICULOS PRIMARY KEY(ARTID)
ALTER TABLE VENTAS ADD CONSTRAINT PK_VENTAS PRIMARY KEY(FOLIO)
ALTER TABLE DETALLE ADD CONSTRAINT PK_DETALLES PRIMARY KEY(FOLIO,ARTID)
GO
-- LLAVES EXTERNAS
ALTER TABLE COLONIAS ADD
CONSTRAINT FK_COLONIAS_MUN FOREIGN KEY(MUNID) REFERENCES MUNICIPIOS(MUNID)
GO
ALTER TABLE EMPLEADOS ADD
CONSTRAINT FK_EMP_EMP FOREIGN KEY(JEFEID) REFERENCES EMPLEADOS(EMPID),
CONSTRAINT FK_EMP_ZONAS FOREIGN KEY(ZONAID) REFERENCES ZONAS(ZONAID)
GO
ALTER TABLE ARTICULOS ADD
CONSTRAINT FK_ARTICULOS_FAMILIAS FOREIGN KEY(FAMID) REFERENCES FAMILIAS(FAMID)
GO
ALTER TABLE CLIENTES ADD
CONSTRAINT FK_CLIENTES_COL FOREIGN KEY(COLID) REFERENCES COLONIAS(COLID)
GO
ALTER TABLE VENTAS ADD
CONSTRAINT FK_VENTAS_FERR FOREIGN KEY(FERRID) REFERENCES FERRETERIAS(FERRID),
CONSTRAINT FK_VENTAS_CTE FOREIGN KEY(CTEID) REFERENCES CLIENTES(CTEID),
CONSTRAINT FK_VENTAS_EMP FOREIGN KEY(EMPID) REFERENCES EMPLEADOS(EMPID)
GO
ALTER TABLE DETALLE ADD
CONSTRAINT FK_DETALLE_ARTIC FOREIGN KEY(ARTID) REFERENCES ARTICULOS(ARTID),
CONSTRAINT FK_DETALLE_VENTAS FOREIGN KEY(FOLIO) REFERENCES VENTAS(FOLIO)
GO
-- LLAVES UNICAS
ALTER TABLE CLIENTES ADD 
CONSTRAINT UC_CLIENTES_RFC UNIQUE(CTERFC),
CONSTRAINT UC_CLIENTES_CURP UNIQUE(CTECURP)
GO
ALTER TABLE EMPLEADOS ADD
CONSTRAINT UC_EMPLEADOS_RFC UNIQUE(EMPRFC),
CONSTRAINT UC_EMPLEADOS_CURP UNIQUE(EMPCURP)
GO
-- VALORES POR DEFAULT
ALTER TABLE EMPLEADOS ADD
CONSTRAINT DC_EMP_DOM DEFAULT('Domicilio desconocido') FOR EMPDOMICILIO,
CONSTRAINT DC_EMP_TEL DEFAULT('SIN TELEFO') FOR EMPTELEFONO
GO
ALTER TABLE CLIENTES ADD
CONSTRAINT DC_CLIENTES_DOM DEFAULT('Domicilio desconocido') FOR CTEDOMICILIO,
CONSTRAINT DC_CLIENTES_TEL DEFAULT('SIN TELEFO') FOR CTETELEFONO
GO
ALTER TABLE COLONIAS ADD
CONSTRAINT DC_COLONIAS_CP DEFAULT('00000') FOR COLCP
GO
-- DE COMPROBACION
ALTER TABLE CLIENTES ADD
CONSTRAINT CC_CLIENTES_SEXO CHECK (CTESEXO IN ('F','M')),
CONSTRAINT CC_CLIENTES_RFC_CURP CHECK (CTERFC <> CTECURP)
GO
ALTER TABLE DETALLE ADD
CONSTRAINT CC_DETALLE_PRECIO CHECK (PRECIO > 0),
CONSTRAINT CC_DETALLE_CANTIDAD CHECK (CANTIDAD > 0)
GO
ALTER TABLE ARTICULOS ADD
CONSTRAINT CC_ARTICULOS_PRECIO CHECK (ARTPRECIO > 0)
GO
ALTER TABLE VENTAS ADD
CONSTRAINT CC_VENTAS_FECHA CHECK (FECHA>'1-1-2018')
GO
-- INSERCIONES
INSERT INTO ZONAS VALUES(1,'NORTE')
INSERT INTO ZONAS VALUES(2,'SUR')
INSERT INTO ZONAS VALUES(3,'ESTE')
INSERT INTO ZONAS VALUES(4,'OESTE')
INSERT INTO ZONAS VALUES(5,'NOROESTE')

INSERT INTO MUNICIPIOS VALUES(1,'CULIACAN')
INSERT INTO MUNICIPIOS VALUES(2,'MAZATLAN')
INSERT INTO MUNICIPIOS VALUES(3,'AHOME')
INSERT INTO MUNICIPIOS VALUES(4,'ESCUINAPA')
INSERT INTO MUNICIPIOS VALUES(5,'NAVOLATO')

INSERT INTO FAMILIAS VALUES(1,'PISOS','TODO SOBRE PISOS')
INSERT INTO FAMILIAS VALUES(2,'DECORACION','TODO SOBRE ELEMENTOS DECORATIVOS')
INSERT INTO FAMILIAS VALUES(3,'GRIFERIA','TODO SOBRE GRIFOS')
INSERT INTO FAMILIAS VALUES(4,'HERRAMIENTAS','TODO SOBRE HERRAMIENTAS')
INSERT INTO FAMILIAS VALUES(5,'CONSTRUCCION','TODO SOBRE MATERIALES DE CONSTRUCCION')

INSERT INTO FERRETERIAS VALUES(1,'FERRETERIA 1','CENTRO','6672131244')
INSERT INTO FERRETERIAS VALUES(2,'FERRETERIA 2','OBREGON','6672112244')
INSERT INTO FERRETERIAS VALUES(3,'FERRETERIA 3','LAS QUINTAS','6672116486')
INSERT INTO FERRETERIAS VALUES(4,'FERRETERIA 4','VALLE DORADO','6671884527')
INSERT INTO FERRETERIAS VALUES(5,'FERRETERIA 5','ACUEDUCTO','6673888023')

INSERT INTO COLONIAS VALUES(1,'CENTRO',80450,1)
INSERT INTO COLONIAS VALUES(2,'SANTA ANITA',80058,1)
INSERT INTO COLONIAS VALUES(3,'BUENAVISTA',81330,3)
INSERT INTO COLONIAS VALUES(4,'SAN PEDRO',DEFAULT,5)
INSERT INTO COLONIAS VALUES(5,'SAN LORENZO',82301,2)

INSERT INTO EMPLEADOS VALUES(1,'CARLOS','BELTRAN','MEDINA','CALLE #1353','6673887074','6673887075','BEMC031030HSL','BEMC031030HSLLDRA5','10/20/2022','03/09/2003',1,NULL)
INSERT INTO EMPLEADOS VALUES(2,'KAREN','BELTRAN','ONTIVEROS','CALLE #1323','6673667074','6673667075','BEOK031030HSL','BEOK031030HSLLDRA5','01/01/2022','02/02/2003',1,1)
INSERT INTO EMPLEADOS VALUES(3,'CESAR','VALENZUELA','BERRELLEZA',DEFAULT,'6673007074','6673007075','VABC031030HSL','VABC031030HSLLDRA5','10/01/2022','01/05/2003',3,2)
INSERT INTO EMPLEADOS VALUES(7,'RICARDO','AGUILAR','FLORES','CALLE #2113',DEFAULT,'6672307075','AUFR770826MPL','AUFR770826MPLGLC63','01/01/2022','01/08/1995',4,NULL)
INSERT INTO EMPLEADOS VALUES(11,'ANGEL','GUZMAN','SOTO','CALLE #2333','6672323074','6672332075','GUSL770826MYN','GUSL770826MYNZTS83','01/05/2022','01/05/2000',5,7)

INSERT INTO CLIENTES VALUES(5,'CESAR','AVILES','BRAVO','CALLE #1532','6673992016','3321923649','AVBC1203HSLLD','AVBC031030HSLLDRA5','11/02/2003','M',4)
INSERT INTO CLIENTES VALUES(7,'MARÍA','CASTRO','MUNOZ','CALLE #1234','6672394316','5521921648','CAMM770826LLD','CAMM770826HCXSNR86','01/08/1977','F',1)
INSERT INTO CLIENTES VALUES(3,'MANUEL','MEDINA','PENA',DEFAULT,'6671292326','3332921243','MEPM770826MYN','MEPM770826MYNDNN77','01/02/2000','M',2)
INSERT INTO CLIENTES VALUES(10,'ALFREDO','CASTILLO','JIMENEZ','CALLE #1642','6671192016','5321923639','CAJA770826HTC','CAJA770826HTCSML85','01/01/1988','M',3)
INSERT INTO CLIENTES VALUES(4,'MARIA','ORTIZ','GARZA','CALLE #6325',DEFAULT,'2421934649','OIGM770826HJC','OIGM770826HJCRRR36','01/07/1998','F',2)

INSERT INTO ARTICULOS VALUES(1,'MARTILLO','BUEN MARTILLO',150.99,4)
INSERT INTO ARTICULOS VALUES(2,'TALADRO','BUEN TALADRO',1150.99,4)
INSERT INTO ARTICULOS VALUES(3,'LADRILLO','BUEN LADRILLO',20.00,5)
INSERT INTO ARTICULOS VALUES(4,'GRIFO','BUEN GRIFO',2150.99,3)
INSERT INTO ARTICULOS VALUES(5,'MOSAICO','BUEN MOSAICO',50.99,1)

INSERT INTO VENTAS VALUES(1,'10/10/2022',1,3,1)
INSERT INTO VENTAS VALUES(2,'01/12/2022',2,5,2)
INSERT INTO VENTAS VALUES(3,'02/04/2022',2,7,3)
INSERT INTO VENTAS VALUES(4,'03/01/2022',3,4,7)
INSERT INTO VENTAS VALUES(5,'04/12/2022',5,10,11)

INSERT INTO DETALLE VALUES(1,2,1,1150.99)
INSERT INTO DETALLE VALUES(2,1,1,150.99)
INSERT INTO DETALLE VALUES(3,4,2,4000.99)
INSERT INTO DETALLE VALUES(4,2,3,3000.99)
INSERT INTO DETALLE VALUES(5,5,10,500.00)