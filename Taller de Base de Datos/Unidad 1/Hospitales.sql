CREATE DATABASE HOSPITALES
GO
USE HOSPITALES
GO
-- CREACION DE TABLAS
CREATE TABLE HOSPITALES(
HOSPID INT NOT NULL,
HOSPNOMBRE NVARCHAR(20) NOT NULL,
HOSPDIRECCION NVARCHAR(50) NOT NULL,
HOSPTELEFONO NCHAR(10) NOT NULL)
GO
CREATE TABLE CONSULTORIOS(
CONSID INT NOT NULL,
CONSPISO INT NOT NULL,
CONSPASILLO INT NOT NULL,
CONSTELEFONO NCHAR(10) NOT NULL,
HOSPID INT NOT NULL)
GO
CREATE TABLE ESPECIALIDADES(
ESPID INT NOT NULL,
ESPNOMBRE NVARCHAR(20) NOT NULL,
ESPDESCRIPCION NVARCHAR(50) NOT NULL)
GO
CREATE TABLE DOCTORES(
DOCID INT NOT NULL,
DOCNOMBRE NVARCHAR(20) NOT NULL,
DOCAPEPAT NVARCHAR(20) NOT NULL,
DOCAPEMAT NVARCHAR(20) NULL,
DOCTELEFONO NCHAR(10) NULL,
DOCCORREO NVARCHAR(50) NULL,
DOCRFC NCHAR(13) NULL,
DOCCURP NCHAR(18) NULL,
ESPID INT NOT NULL)
GO
CREATE TABLE LABORATORIOS(
LABID INT NOT NULL,
LABNOMBRE NVARCHAR(20) NOT NULL,
LABDIRECCION NVARCHAR(50) NOT NULL,
LABTELEFONO NCHAR(10) NOT NULL)
GO
CREATE TABLE MEDICAMENTOS(
MEDID INT NOT NULL,
MEDNOMBRE NVARCHAR(20) NOT NULL,
MEDDESCRIPCION NVARCHAR(50) NULL,
MEDSUSTANCIAACTIVA NVARCHAR(20) NOT NULL,
MEDPRESENTACION NVARCHAR(20) NOT NULL,
MEDCANTIDAD INT NOT NULL,
LABID INT NOT NULL)
GO
CREATE TABLE PACIENTES(
PACID INT NOT NULL,
PACNOMBRE NVARCHAR(20) NOT NULL,
PACAPEPAT NVARCHAR(20) NOT NULL,
PACAPEMAT NVARCHAR(20) NULL,
PACDOMICILIO NVARCHAR(50) NULL,
PACFECHANACIMIENTO DATETIME NOT NULL,
PACSEXO NCHAR(1) NOT NULL,
PACCURP NCHAR(18) NULL,
PACTELEFONO NCHAR(10) NULL)
GO
CREATE TABLE CITAS(
CITID INT NOT NULL,
CITFECHA DATETIME NOT NULL,
CITPRESIONPAC INT NOT NULL,
CITPESOPAC INT NOT NULL,
CITALTURAPAC INT NOT NULL,
CITSINTOMAS NVARCHAR(80) NOT NULL,
CITDIAGNOSTICO NVARCHAR(80) NOT NULL,
CONSID INT NOT NULL,
DOCID INT NOT NULL,
PACID INT NOT NULL)
GO
CREATE TABLE RECETAS(
RECFOLIO INT NOT NULL,
RECFECHA DATETIME NOT NULL,
RECNOTAS NVARCHAR(50) NULL,
CITID INT NOT NULL)
GO
CREATE TABLE DETALLE(
RECFOLIO INT NOT NULL,
MEDID INT NOT NULL,
DOSIS NVARCHAR(30) NOT NULL)
GO
-- CREACION DE LLAVES PRIMARIAS
ALTER TABLE HOSPITALES ADD CONSTRAINT PK_HOSPITALES PRIMARY KEY(HOSPID)
ALTER TABLE CONSULTORIOS ADD CONSTRAINT PK_CONSULTORIOS PRIMARY KEY(CONSID)
ALTER TABLE ESPECIALIDADES ADD CONSTRAINT PK_ESPECIALIDADES PRIMARY KEY(ESPID)
ALTER TABLE DOCTORES ADD CONSTRAINT PK_DOCTORES PRIMARY KEY(DOCID)
ALTER TABLE LABORATORIOS ADD CONSTRAINT PK_LABORATORIOS PRIMARY KEY(LABID)
ALTER TABLE MEDICAMENTOS ADD CONSTRAINT PK_MEDICAMENTOS PRIMARY KEY(MEDID)
ALTER TABLE PACIENTES ADD CONSTRAINT PK_PACIENTES PRIMARY KEY(PACID)
ALTER TABLE CITAS ADD CONSTRAINT PK_CITAS PRIMARY KEY(CITID)
ALTER TABLE RECETAS ADD CONSTRAINT PK_RECETAS PRIMARY KEY(RECFOLIO)
ALTER TABLE DETALLE ADD CONSTRAINT PK_DETALLE PRIMARY KEY(RECFOLIO,MEDID)
GO
-- LLAVES EXTERNAS
ALTER TABLE MEDICAMENTOS ADD
CONSTRAINT FK_MEDICAMENTOS_LAB FOREIGN KEY(LABID) REFERENCES LABORATORIOS(LABID)
GO
ALTER TABLE DOCTORES ADD
CONSTRAINT FK_DOCTORES_ESP FOREIGN KEY(ESPID) REFERENCES ESPECIALIDADES(ESPID)
GO
ALTER TABLE CONSULTORIOS ADD
CONSTRAINT FK_CONSULTORIOS_HOSP FOREIGN KEY(HOSPID) REFERENCES HOSPITALES(HOSPID)
GO
ALTER TABLE CITAS ADD
CONSTRAINT FK_CITAS_CONS FOREIGN KEY(CONSID) REFERENCES CONSULTORIOS(CONSID),
CONSTRAINT FK_CITAS_PAC FOREIGN KEY(PACID) REFERENCES PACIENTES(PACID),
CONSTRAINT FK_CITAS_DOC FOREIGN KEY(DOCID) REFERENCES DOCTORES(DOCID)
GO
ALTER TABLE RECETAS ADD
CONSTRAINT FK_RECETAS_CIT FOREIGN KEY(CITID) REFERENCES CITAS(CITID)
GO
ALTER TABLE DETALLE ADD
CONSTRAINT FK_DETALLE_REC FOREIGN KEY(RECFOLIO) REFERENCES RECETAS(RECFOLIO),
CONSTRAINT FK_DETALLE_MED FOREIGN KEY(MEDID) REFERENCES MEDICAMENTOS(MEDID)
GO
-- LLAVES UNICAS
ALTER TABLE DOCTORES ADD 
CONSTRAINT UC_DOCTORES_RFC UNIQUE(DOCRFC),
CONSTRAINT UC_DOCTORES_CURP UNIQUE(DOCCURP)
GO
ALTER TABLE PACIENTES ADD
CONSTRAINT UC_PACIENTES_CURP UNIQUE(PACCURP)
GO
-- VALORES POR DEFAULT
ALTER TABLE DOCTORES ADD
CONSTRAINT DC_DOCTORES_TEL DEFAULT('SIN TELEFO') FOR DOCTELEFONO,
CONSTRAINT DC_DOCTORES_COR DEFAULT('SIN CORREO') FOR DOCCORREO
GO
ALTER TABLE PACIENTES ADD
CONSTRAINT DC_PACIENTES_DOM DEFAULT('Domicilio desconocido') FOR PACDOMICILIO,
CONSTRAINT DC_PACIENTES_TEL DEFAULT('SIN TELEFO') FOR PACTELEFONO
GO
-- DE COMPROBACION
ALTER TABLE PACIENTES ADD
CONSTRAINT CC_PACIENTES_SEXO CHECK (PACSEXO IN ('F','M'))
GO
ALTER TABLE MEDICAMENTOS ADD
CONSTRAINT CC_MEDICAMENTOS_CANTIDAD CHECK (MEDCANTIDAD > 0)
GO
ALTER TABLE CITAS ADD
CONSTRAINT CC_CITAS_FECHA CHECK (CITFECHA > '1-1-2018'),
CONSTRAINT CC_CITAS_PRESION CHECK (CITPRESIONPAC > 0),
CONSTRAINT CC_CITAS_PESO CHECK (CITPESOPAC > 0),
CONSTRAINT CC_CITAS_ALTURA CHECK (CITALTURAPAC > 0)
GO
ALTER TABLE RECETAS ADD
CONSTRAINT CC_RECETAS_FECHA CHECK (RECFECHA>'1-1-2018')
GO
-- INSERCIONES
INSERT INTO HOSPITALES VALUES(1,'HOSPITAL 1','CALLE #1254','6673887075')
INSERT INTO HOSPITALES VALUES(2,'HOSPITAL 2','CALLE #1234','6673117075')
INSERT INTO HOSPITALES VALUES(3,'HOSPITAL 3','CALLE #2254','6612282755')
INSERT INTO HOSPITALES VALUES(4,'HOSPITAL 4','CALLE #7854','6673295375')
INSERT INTO HOSPITALES VALUES(5,'HOSPITAL 5','CALLE #7754','6673777075')

INSERT INTO LABORATORIOS VALUES(1,'LABORATORIO 1','CALLE #1532','6672131245')
INSERT INTO LABORATORIOS VALUES(2,'LABORATORIO 2','CALLE #1122','6671231245')
INSERT INTO LABORATORIOS VALUES(3,'LABORATORIO 3','CALLE #4322','6676431245')
INSERT INTO LABORATORIOS VALUES(4,'LABORATORIO 4','CALLE #1342','6672121223')
INSERT INTO LABORATORIOS VALUES(5,'LABORATORIO 5','CALLE #9992','6672164375')

INSERT INTO ESPECIALIDADES VALUES(1,'CARDIOLOGO','TODO SOBRE EL CORAZON')
INSERT INTO ESPECIALIDADES VALUES(2,'NEUMOLOGIA','TODO SOBRE LOS PULMONES')
INSERT INTO ESPECIALIDADES VALUES(3,'GERIATRIA','TRATAR ENFERMEDADES DE PERSONAS MAYORES')
INSERT INTO ESPECIALIDADES VALUES(4,'PEDIATRIA','TRATAR ENFERMEDADES DE NIÑOS')
INSERT INTO ESPECIALIDADES VALUES(5,'NEUROLOGIA','TODO SOBRE EL SISTEMA NERVIOSO')

INSERT INTO PACIENTES VALUES(1,'GABRIEL','AGUILAR','GUZMAN','CALLE #1234','10/20/1990','M','AUGG770826MZSGZB65','6673887076')
INSERT INTO PACIENTES VALUES(2,'ANDREA','VEGA','FERNANDEZ','CALLE #1212','01/10/1991','F','VEFA770826MJCGRN38','6673117076')
INSERT INTO PACIENTES VALUES(3,'ELIZABETH','GOMEZ','MORALES',DEFAULT,'08/26/1977','F','GOME770826MPLMRL57',DEFAULT)
INSERT INTO PACIENTES VALUES(4,'ANTONIO','FLORES','SANTIAGO','CALLE #5932','08/26/1977','F','FOSJ770826HVZLNS36','6673343076')
INSERT INTO PACIENTES VALUES(5,'MARIA','GARCIA','VASQUEZ',DEFAULT,'09/22/1999','F','GAVA770826MCMRSN86','6671234076')

INSERT INTO CONSULTORIOS VALUES(1,1,5,'6671204657',2)
INSERT INTO CONSULTORIOS VALUES(2,3,1,'6671234657',1)
INSERT INTO CONSULTORIOS VALUES(3,1,2,'6671123457',5)
INSERT INTO CONSULTORIOS VALUES(4,2,1,'6671246123',3)
INSERT INTO CONSULTORIOS VALUES(5,1,1,'6671832057',4)

INSERT INTO MEDICAMENTOS VALUES(1,'MEDICAMENTO 1','BUEN MEDICAMENTO','IBUPROFENO','CAPSULA',50,2)
INSERT INTO MEDICAMENTOS VALUES(2,'MEDICAMENTO 2','BUEN MEDICAMENTO','PARACETAMOL','PASTILLA',100,5)
INSERT INTO MEDICAMENTOS VALUES(3,'MEDICAMENTO 3','BUEN MEDICAMENTO','LORACEPAN','PASTILLA',20,4)
INSERT INTO MEDICAMENTOS VALUES(4,'MEDICAMENTO 4','BUEN MEDICAMENTO','SALBUTAMOL','JARABE',200,1)
INSERT INTO MEDICAMENTOS VALUES(5,'MEDICAMENTO 5','BUEN MEDICAMENTO','DIAZEPAN','CAPSULA',50,2)

INSERT INTO DOCTORES VALUES(1,'CARLOS','BELTRAN','MEDINA','6673887074','BELTRANMED.CARLOS03@GMAIL.COM','BEMC031030LDG','BEMC031030HSLLDRA5',1)
INSERT INTO DOCTORES VALUES(2,'KAREN','BELTRAN','ONTIVEROS','6671234074','KAREN.BELTRAN@GMAIL.COM','BEOK031030LDG','BEOK031030HSLLDRA5',5)
INSERT INTO DOCTORES VALUES(3,'CESAR','VALENZUELA','BERRELLEZA','6671123774',DEFAULT,'VABC031030LDG','VABC031030HSLLDRA5',4)
INSERT INTO DOCTORES VALUES(4,'ELIZABETH','MEDINA','MORENO','6671121234','ELI.MEDINA@HOTMAIL.COM','MEME770826MMC','MEME770826MMCDRL38',4)
INSERT INTO DOCTORES VALUES(5,'FRANCISCA','VARGAS','VEGA',DEFAULT,'FRAN.VARGAS@HOTMAIL.COM','VAVF770826HSR','VAVF770826HSRRGR78',3)

INSERT INTO CITAS VALUES(1,'10/10/2022',100,70,170,'DOLOR DE PANZA','INFECCION EN EL ESTOMAGO',1,5,2)
INSERT INTO CITAS VALUES(2,'12/30/2022',120,60,160,'DOLOR DE CABEZA','CANCER',2,3,1)
INSERT INTO CITAS VALUES(3,'01/01/2023',90,70,182,'DOLOR MUSCULAR','FRACTURA',5,2,5)
INSERT INTO CITAS VALUES(4,'02/02/2023',95,75,168,'CALENTURA','GRIPA',2,5,1)
INSERT INTO CITAS VALUES(5,'03/03/2023',95,80,175,'RONCHAS EN LA PIEL','INFECCION EN LA PIEL',4,1,4)

INSERT INTO RECETAS VALUES(1,'10/10/2022',NULL,1)
INSERT INTO RECETAS VALUES(2,'12/31/2022','TOMAR ANTES DE COMER',2)
INSERT INTO RECETAS VALUES(3,'03/03/2023',NULL,5)
INSERT INTO RECETAS VALUES(4,'02/02/2023',NULL,4)
INSERT INTO RECETAS VALUES(5,'01/01/2023','SOLO SI TIENE MALESTAR',3)

INSERT INTO DETALLE VALUES(1,2,'CADA 8 HORAS')
INSERT INTO DETALLE VALUES(3,1,'CADA 12 HORAS')
INSERT INTO DETALLE VALUES(2,4,'CADA 8 HORAS')
INSERT INTO DETALLE VALUES(4,4,'CADA 8 HORAS')
INSERT INTO DETALLE VALUES(5,5,'CADA 12 HORAS')